<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zona Gamer - Ticket</title>

<link rel="stylesheet" href="css/styleTicket.css">
</head>

<body>

<button class="theme-btn" onclick="toggleTheme()">ðŸŒ™</button>

<div class="ticket-container">

    <h1>ðŸŽ® Zona Gamer</h1>
    <h2>Ticket de Compra</h2>

    <div id="ticket" class="ticket-card"></div>

    <div class="acciones">
        <button class="btn-pdf" onclick="window.print()">Descargar PDF</button>
        <button class="btn-salir" onclick="salir()">Salir</button>
    </div>

</div>

<script>
function cargarTicket() {
    const data = JSON.parse(localStorage.getItem("ticket"));
    const contenedor = document.getElementById("ticket");

    if (!data) {
        contenedor.innerHTML = "<p>No hay ticket disponible.</p>";
        return;
    }

    let html = `
        <p><strong>Cliente:</strong> ${data.nombre_cliente}</p>
        <p><strong>Fecha:</strong> ${new Date().toLocaleDateString()}</p>
        <hr>
    `;

    data.Productos.forEach(p => {
        html += `
            <div class="item-ticket">
                <span>${p.nombre}</span>
                <span>x${p.VentaProducto.cantidad}</span>
            </div>
        `;
    });

    html += `
        <hr>
        <h3>Total: $${data.total}</h3>
    `;

    contenedor.innerHTML = html;
}

function salir() {
    localStorage.removeItem("ticket");
    localStorage.removeItem("nombreUsuario");
    window.location.href = "encuesta.html";
}

function toggleTheme() {
    document.body.classList.toggle("dark");
    localStorage.setItem("tema",
        document.body.classList.contains("dark") ? "dark" : "light"
    );
}

window.onload = function () {
    if (localStorage.getItem("tema") === "dark") {
        document.body.classList.add("dark");
    }
    cargarTicket();
};
</script>

</body>
</html>